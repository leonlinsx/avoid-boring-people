---
import { Moon, Sun } from 'lucide-astro';
---

<footer class="site-footer">
  <div class="footer-container">
    <p>
      <a
        href="https://www.threads.net/@leon.lin.sx"
        target="_blank"
        rel="noopener noreferrer"
      >
        Threads
      </a>
      ·
      <a
        href="https://twitter.com/leonlinsx"
        target="_blank"
        rel="noopener noreferrer"
      >
        Twitter
      </a>

      <a
        href="https://github.com/leonlinsx"
        target="_blank"
        rel="noopener noreferrer"
      >
        Github
      </a>
      ·
      <a href="/rss.xml">RSS Feed</a>
      ·
      <button
        id="dark-mode-toggle"
        aria-label="Toggle dark mode"
        title="Toggle dark mode"
        class="dark-mode-toggle"
      >
        <Moon class="icon moon" />
        <Sun class="icon sun" />
      </button>
    </p>
    <p>© {new Date().getFullYear()} Leon Lin</p>
  </div>
</footer>

<script is:inline>
  const toggle = document.getElementById('dark-mode-toggle');

  function setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
  }

  function getPreferredTheme() {
    const stored = localStorage.getItem('theme');
    if (stored) return stored;
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  }

  if (toggle) {
    toggle.addEventListener('click', () => {
      const current =
        document.documentElement.getAttribute('data-theme') || 'light';
      setTheme(current === 'dark' ? 'light' : 'dark');
    });
  }

  setTheme(getPreferredTheme());
</script>

<style>
  .site-footer {
    width: 100%;
    border-top: 1px solid var(--color-border);
    background: var(--color-bg);
  }

  .footer-container {
    max-width: var(--max-content-width);
    margin: 0 auto;
    padding: var(--space-lg) var(--space-md);
    text-align: center;
    font-size: 0.9rem;
    color: var(--color-text-muted);
  }

  .footer-container a {
    color: var(--color-text);
    text-decoration: none;
    margin: 0 var(--space-sm);
    transition: color 0.2s;
  }

  .footer-container a:hover {
    color: var(--color-link);
    text-decoration: underline;
  }

  .dark-mode-toggle {
    background: none;
    border: none;
    cursor: pointer;
    color: var(--color-text-muted);
    font-size: 0.9rem;
    display: inline-flex;
    align-items: center;   /* centers flex children vertically */
    justify-content: center;
    padding: 0;
    margin-left: var(--space-xs);
    transition: color 0.2s ease;
    line-height: 1;        /* keeps button height tight */
  }

  .dark-mode-toggle:hover {
    color: var(--color-link);
  }

  /* icon sizing */
  .dark-mode-toggle .icon {
    width: 1.1em;          /* slightly larger than text for balance */
    height: 1.1em;
    vertical-align: middle;
    position: relative;
    top: 0.15em;           /* ✅ small nudge down to align with text baseline */
  }

  /* default: hide both */
  .dark-mode-toggle .icon {
    display: none !important;
  }

  /* light mode shows moon */
  html[data-theme='light'] .dark-mode-toggle .icon.moon {
    display: inline-block !important;
  }

  /* dark mode shows sun */
  html[data-theme='dark'] .dark-mode-toggle .icon.sun {
    display: inline-block !important;
  }
</style>
