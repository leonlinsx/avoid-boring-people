---
const { post } = Astro.props;

// Safe destructuring with fallbacks
const title = post?.data?.title ?? "Untitled";
const desc = post?.data?.description ?? "";
const category = post?.data?.category ?? "";
const date = post?.data?.pubDate ? new Date(post.data.pubDate) : null;
const rt = post?.data?.readingTime; // number of minutes
const href = `/writing/${post?.slug || post?.id || ""}/`;
---

<article class="post-card">
  <h2 class="post-title">
    <a href={href}>{title}</a>
  </h2>

  {desc && <p class="post-summary">{desc}</p>}

  <p class="post-meta">
    {category}
    {
      date &&
        ` · ${date.toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
        })}`
    }
    {rt && ` · ${rt} min read`}
  </p>
</article>

<style>
  .post-card {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--color-border);
  }

  .post-title {
    font-size: 1.4rem;
    margin-bottom: 0.4rem;
  }

  .post-title a {
    text-decoration: none;
    color: var(--color-text);
  }

  .post-title a:hover {
    text-decoration: underline;
  }

  .post-summary {
    color: #555;
    margin-bottom: 0.3rem;
  }

  .post-meta {
    font-size: 0.9rem;
    color: #777;
  }
</style>
